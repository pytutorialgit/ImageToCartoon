<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>Cartoonizer</title>
    <script src="https://cdn.jsdelivr.net/npm/vue/dist/vue.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
</head>
<body>
  <!-- The Vue app -->
    <div id="app">
        <h1>Cartoonizer</h1>
        <p>
            Upload an image and click the "Cartoonize" button to apply a cartoon effect to it.
        </p>
        <input type="file" v-on:change="onFileSelected">
         <!-- When the "Cartoonize" button is clicked, the "cartoonizeImage" method is called -->
        <button v-on:click="cartoonizeImage">Cartoonize</button>
        <br><br>
         <!-- If a cartoonized image has been generated by the server, display it using an img element -->
        <div v-if="cartoonizedImage">
            <img :src="cartoonizedImage" style="max-width: 80%; max-height: 80%; ">
        </div>
    </div>
    <script>
       new Vue({
    el: '#app',

    data: {
        imageFile: null,        // The selected image file
        cartoonizedImage: null  // The cartoonized image generated by the server
    },

    methods: {
        // Handler for when the user selects an image file
        onFileSelected(event) {
            this.imageFile = event.target.files[0]; 
        },

        // Handler for when the user clicks the "Cartoonize" button
        cartoonizeImage() {
            if (!this.imageFile) { 
                return;
            }

            
            const formData = new FormData();
            formData.append('image', this.imageFile);

            // Send a POST request to the flask server with the selected image file as the payload
            axios.post('/cartoonize', formData, {
                headers: {
                    'Content-Type': 'multipart/form-data' // Set the Content-Type header to multipart/form-data
                }
            }).then(response => {
                // Set the cartoonized image to the data property, with the base64 encoding
                this.cartoonizedImage = 'data:image/jpeg;base64,' + response.data.data;
            }).catch(error => {
                console.log(error); // Log any errors to the console
            });
        }
    }
});
    </script>
</body>
</html>
